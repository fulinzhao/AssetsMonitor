# Price Monitor 项目说明

## 1. 项目是做什么的

`price_monitor` 是一个轻量级资产行情监控看板，面向“快速查看核心市场价格”的场景。  
它将加密资产和传统金融资产放在同一个界面中轮播展示，支持移动端滑动切换，并尽量保证在网络波动或上游接口异常时仍可返回可用数据（降级为 DemoFeed）。

当前默认覆盖的资产包括：
- 加密资产：`BTC/USD`、`ETH/USD`
- 传统资产：`XAU/USD`（黄金）、`SPX`（标普 500）、`NDX`（纳斯达克 100）

---

## 2. 技术栈

### 前端
- `React 19`：构建界面和状态管理
- `Vite 7` + `@vitejs/plugin-react`：开发与构建工具链
- 原生 `CSS`：响应式视觉样式与交互样式
- `localStorage`：持久化用户设置（轮播间隔、关注标的）

### 数据代理 / 服务端
- `Vercel Serverless Function`（`vercel-proxy/api/quote.js`）  
  对外提供统一 `GET /quote?symbol=...` 接口
- `Cloudflare Worker`（`cloudflare-worker/src/index.js`）  
  也提供同样的统一行情接口，可作为代理层替代部署

### 上游数据源
- `OKX API`：获取加密资产行情（如 `BTC-USDT`、`ETH-USDT`）
- `Yahoo Finance Chart API`：获取黄金、指数等传统资产行情

### CI/CD 与托管
- `GitHub Actions`：自动构建并发布前端静态产物
- `GitHub Pages`：托管前端站点
- `Vercel` / `Cloudflare`：托管行情代理接口

---

## 3. 已实现功能

### 3.1 行情展示与轮播
- 展示当前标的价格、涨跌额、涨跌幅、更新时间、数据来源标记
- 按设定间隔自动轮播切换标的（默认 10 秒）
- 支持左右按钮切换，以及移动端左右滑动切换

### 3.2 自定义设置
- 可配置轮播间隔（5s / 10s / 15s / 30s）
- 可选择展示哪些标的（至少保留 1 个）
- 设置写入 `localStorage`，刷新后保留

### 3.3 统一行情接口与容错
- 前端只调用一个代理入口：`VITE_QUOTE_PROXY_BASE_URL/quote?symbol=...`
- 代理层根据 `symbol` 路由到不同上游源（OKX 或 Yahoo）
- 当上游异常时，返回 `DemoFeed` 模拟行情，保证界面不中断
- 接口包含 CORS 头，便于跨域访问前端页面

### 3.4 体验与可读性
- 大字号主价格展示，适合大屏/横屏快速瞥读
- 响应式布局，兼顾桌面与移动端
- 数字格式化（价格、小数位、百分比、时间）提升可读性

---

## 4. 适用场景

- 个人资产观察看板：低成本、低维护地监控常见市场价格
- 展示屏或副屏行情卡片：以“轮播 + 大字”形式持续显示
- 学习型项目：练习“前端 + 边缘函数 + 第三方 API 聚合 + 容错降级”
- 原型验证：快速验证跨市场（加密 + 传统）统一行情入口方案

---

## 5. 技术架构

整体采用“静态前端 + 边缘代理 + 多上游源”的三层结构。

1. **展示层（Frontend）**
   - React 页面负责 UI 渲染、轮播逻辑、设置管理
   - 仅依赖统一行情接口，不直接请求第三方平台

2. **聚合层（Quote Proxy）**
   - 使用 Vercel Function 或 Cloudflare Worker 实现
   - 对外统一路径：`/quote?symbol=<id>`
   - 内部进行 symbol -> 上游市场映射与数据标准化

3. **数据源层（Upstream APIs）**
   - OKX：提供加密标的行情
   - Yahoo Finance：提供黄金与指数类行情
   - 若调用失败，聚合层返回 DemoFeed 兜底

### 数据流（简化）
- 浏览器请求 `GET {PROXY_BASE_URL}/quote?symbol=btc`
- 代理层识别 `btc`，转发到 OKX 并计算涨跌信息
- 返回统一 JSON：`price/change/changePct/asOf/sourceTag/...`
- 前端更新当前卡片并显示来源与更新时间

---

## 6. 项目目录（关键部分）

- `src/`
  - `App.jsx`：主页面、轮播、设置、交互
  - `services/quoteService.js`：前端请求代理与前端兜底逻辑
  - `config/symbols.js`：标的清单与默认轮播配置
  - `utils/format.js`：价格/涨跌/时间格式化工具
- `vercel-proxy/`
  - `api/quote.js`：Vercel 版统一行情接口
  - `vercel.json`：路由重写与 CORS 响应头
- `cloudflare-worker/`
  - `src/index.js`：Worker 版统一行情接口
  - `wrangler.toml`：Worker 入口与兼容配置
- `.github/workflows/deploy.yml`
  - 前端自动构建并发布到 GitHub Pages

---

## 7. 部署方式概览

1. 前端通过 GitHub Actions 构建并发布到 GitHub Pages  
2. 构建时注入 `VITE_QUOTE_PROXY_BASE_URL`（例如 Vercel 或 Worker 地址）  
3. 前端运行时通过该环境变量访问统一行情接口

示例环境变量：

```bash
VITE_QUOTE_PROXY_BASE_URL=https://assets-monitor-proxy.vercel.app
```

---

## 8. 当前设计特点与可扩展方向

### 设计特点
- 前后端解耦：前端不绑定具体上游平台
- 接口统一：多市场数据在代理层标准化
- 高可用导向：上游异常时自动降级
- 成本较低：前端静态托管 + 边缘函数按需调用

### 可扩展方向
- 增加更多标的与市场（外汇、国债、商品等）
- 增加历史趋势图（分钟/小时/日线）
- 增加阈值提醒（价格突破、涨跌幅报警）
- 增加多主题与多语言支持
- 加入简单鉴权与请求频控，提升生产环境稳健性

---

## 9. 一句话总结

这是一个以“统一行情入口 + 稳定展示 + 快速部署”为核心目标的市场价格监控看板项目，适合作为个人监控工具和边缘聚合架构实践模板。
